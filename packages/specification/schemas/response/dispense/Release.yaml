# https://github.com/OzzyCzech/mock-to-openapi

type: object
description: |
  The requested prescriptions,
  expressed as a FHIR bundle of 
  [prescription-order FHIR messages](https://simplifier.net/guide/NHSDigital-Medicines/Home/FHIRAssets/AllAssets/MessageDefinition-duplicate-2/prescription-order).
properties:
  resourceType:
    type: string
    default: Parameters
  id:
    type: string
    example: a5d77265-8ba5-4c74-b8ce-ea0dbaafbdb8
  parameter:
    type: array
    items:
      oneOf:
      - $ref: "#/components/schema/passedPrescriptions"
      - $ref: "#/components/schema/failedPrescriptions"

components:
  schema:
    passedPrescriptions:
      type: object
      properties:
        name:
          type: string
          default: passedPrescriptions
        resource:
          type: object
          properties:
            resourceType:
              type: string
              default: Bundle
            id:
              type: string
              example: 155e1102-9e71-4f19-9453-b905c0bbc494
            meta:
              type: object
              properties:
                lastUpdated:
                  type: string
                  format: date-time
                  example: "2023-03-13T14:00:00+00:00"
            identifier:
              type: object
              properties:
                system:
                  type: string
                  example: https://tools.ietf.org/html/rfc4122
                value:
                  type: string
                  example: 155e1102-9e71-4f19-9453-b905c0bbc494
            type:
              type: string
              default: searchset
            link:
              type: array
              items:
                type: object
                properties:
                  relation:
                    type: string
                    example: self
                  url:
                    type: string
                    example: https://sandbox.api.service.nhs.uk/electronic-prescriptions/Task/$release
            total:
              type: integer
              format: int32
              example: 1
            entry:
              type: array
              items:
                type: object
                properties:
                  fullUrl:
                    type: string
                    example: urn:uuid:0cb82cfa-76c8-4fb2-a08e-bf0e326e5487
                  search:
                    type: object
                    properties:
                      mode:
                        type: string
                        example: match
                  resource:
                    type: object
                    properties:
                      resourceType:
                        type: string
                        default: Bundle
                      id:
                        type: string
                        example: 0cb82cfa-76c8-4fb2-a08e-bf0e326e5487
                      timestamp:
                        type: string
                        format: date-time
                        example: "2023-03-13T13:47:00+00:00"
                      identifier:
                        type: object
                        properties:
                          system:
                            type: string
                            example: https://tools.ietf.org/html/rfc4122
                          value:
                            type: string
                            example: 46183abc-9fad-4673-85db-ce2cb6614732
                      type:
                        type: string
                        example: message
                      entry:
                        type: array
                        items:
                          oneOf:
                          - $ref: "../../components/MessageHeader/ReleaseResponseMessageHeader.yaml"
                          - $ref: "../../components/MedicationRequest/ReleaseResponseMedicationRequest.yaml"
                          - $ref: "../../components/Patient/Patient.yaml"
                          # - $ref: "../../components/PractitionerRole/ReleaseResponsePractitionerRole.yaml"
                          # - $ref: "../../components/Practitioner/ReleaseResponsePractitioner.yaml"
                          # - $ref: "../../components/Organization/ReleaseResponseOrganization.yaml"
                          # - $ref: "../../components/Provenance/ReleaseResponseProvenance.yaml"
    failedPrescriptions:
      type: object
      properties:
        name:
          type: string
          enum: [failedPrescriptions]
        resource:
          type: object
          properties:
            resourceType:
              type: string
              enum: [Bundle]
            id:
              type: string
              example: 223cab8a-4173-4e86-9d0b-0afe7bd4965b
            meta:
              type: object
              properties:
                lastUpdated:
                  type: string
                  format: date-time
                  example: "2023-03-09T11:25:25+00:00"
            identifier:
              type: object
              properties:
                system:
                  type: string
                  example: https://tools.ietf.org/html/rfc4122
                value:
                  type: string
                  example: 9fa27fc5-052a-4abf-83ca-aee2742a870e
            type:
              type: string
              enum: [searchset]
            total:
              type: integer
              format: int32
              example: 1
            entry:
              type: array
              items:
                oneOf:
                  - type: object
                    properties:
                      resourceType:
                        type: string
                        enum: [OperationOutcome]
                      meta:
                        type: object
                        properties:
                          lastUpdated:
                            type: string
                            format: date-time
                            example: "2023-03-09T11:25:25+00:00"
                      extension:
                        type: array
                        items:
                          type: object
                          properties:
                            url:
                              type: string
                              example: https://fhir.nhs.uk/StructureDefinition/Extension-Spine-supportingInfo-prescription
                            valueReference:
                              type: object
                              properties:
                                identifier:
                                  type: object
                                  properties:
                                    system:
                                      type: string
                                      example: https://tools.ietf.org/html/rfc4122
                                    value:
                                      type: string
                                      example: 1012093c-788a-445a-a197-04c02fcaf829
                      issue:
                        type: array
                        items:
                          type: object
                          properties:
                            severity:
                              type: string
                              example: error
                            code:
                              type: string
                              example: invalid
                            details:
                              type: object
                              properties:
                                coding:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      system:
                                        type: string
                                        example: https://fhir.nhs.uk/CodeSystem/Spine-ErrorOrWarningCode
                                      code:
                                        type: string
                                        example: INVALID_VALUE
                                      display:
                                        type: string
                                        example: Signature is invalid.
                            expression:
                              type: array
                              items:
                                type: string
                                example: Provenance.signature.data
    Patient:
      type: object
      properties:
        resource:
          type: object
          properties:
            resourceType:
              type: string
              enum: [Patient]
            id:
              type: string
              example: df12b683-483c-486e-a9ef-213f915c997b
            identifier:
              type: array
              items:
                type: object
                properties:
                  extension:
                    type: array
                    items:
                      type: object
                      properties:
                        url:
                          type: string
                          enum: [https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus]
                        valueCodeableConcept:
                          type: object
                          properties:
                            coding:
                              type: array
                              items:
                                type: object
                                properties:
                                  system:
                                    type: string
                                    enum: [https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus]
                                  code:
                                    type: string
                                    example: "01"
                                  display:
                                    type: string
                                    example: Number present and verified
                  system:
                    type: string
                    enum: [https://fhir.nhs.uk/Id/nhs-number]
                  value:
                    type: string
                    example: "9449305552"
            name:
              type: array
              items:
                type: object
                properties:
                  use:
                    type: string
                    enum: [anonymous, maiden, nickname, official, old, temp, usual]
                  family:
                    type: string
                    example: DAVIS
                  given:
                    type: array
                    items:
                      type: string
                      example: JANE
                  prefix:
                    type: array
                    items:
                      type: string
                      example: MRS
            gender:
              type: string
              enum: [female, male, other, unknown]
            birthDate:
              type: string
              format: date
              example: "1999-11-25"
            address:
              type: array
              items:
                type: object
                properties:
                  use:
                    type: string
                    example: [billing, home, temp, work]
                  line:
                    type: array
                    items:
                      type: string
                      example: 53 Harrogate Road
                  postalCode:
                    type: string
                    example: LS7 3PY
            generalPractitioner:
              type: array
              items:
                type: object
                properties:
                  identifier:
                    type: object
                    properties:
                      system:
                        type: string
                        enum: [https://fhir.nhs.uk/Id/ods-organization-code]
                      value:
                        type: string
                        example: B81001
        fullUrl:
          type: string
          example: urn:uuid:df12b683-483c-486e-a9ef-213f915c997b
    Practitioner:
      type: object
      properties:
        resource:
          type: object
          properties:
            resourceType:
              type: string
              enum: [Practitioner]
            id:
              type: string
              example: 80eb635a-fb95-427f-9754-3ef9ca922994
            identifier:
              type: array
              items:
                type: object
                properties:
                  system:
                    type: string
                    enum: [https://fhir.hl7.org.uk/Id/professional-code]
                  value:
                    type: string
                    example: "6150129"
            name:
              type: array
              items:
                type: object
                properties:
                  family:
                    type: string
                    example: FIFTYSEVEN
                  given:
                    type: array
                    items:
                      type: string
                      example: RANDOM
                  prefix:
                    type: array
                    items:
                      type: string
                      example: MR
        fullUrl:
          type: string
          example: urn:uuid:80eb635a-fb95-427f-9754-3ef9ca922994
    Location:
      type: object
      properties:
        resource:
          type: object
          properties:
            resourceType:
              type: string
              enum: [Location]
            id:
              type: string
              example: 86a0d8f6-3f0f-41c1-9140-d2d7e50bbdc0
            address:
              type: object
              properties:
                use:
                  type: string
                  enum: [billing, home, temp, work]
                line:
                  type: array
                  items:
                    type: string
                    example: MUSGROVE PARK HOSPITAL
                postalCode:
                  type: string
                  example: TA1 5DA
        fullUrl:
          type: string
          example: urn:uuid:86a0d8f6-3f0f-41c1-9140-d2d7e50bbdc0
    HealthcareService:
      type: object
      properties:
        resource:
          type: object
          properties:
            resourceType:
              type: string
              enum: [HealthcareService]
            id:
              type: string
              example: e0230cb2-8335-43b7-b7d2-673504a80a2f
            identifier:
              type: array
              items:
                type: object
                properties:
                  system:
                    type: string
                    enum: [https://fhir.nhs.uk/Id/ods-organization-code]
                  value:
                    type: string
                    example: A99968
            location:
              type: array
              items:
                type: object
                properties:
                  reference:
                    type: string
                    example: urn:uuid:86a0d8f6-3f0f-41c1-9140-d2d7e50bbdc0
            name:
              type: string
              example: SOMERSET BOWEL CANCER SCREENING CENTRE
            telecom:
              type: array
              items:
                type: object
                properties:
                  system:
                    type: string
                    example: phone
                  use:
                    type: string
                    enum: [billing, home, temp, work]
                  value:
                    type: string
                    example: "01823333444"
            providedBy:
              type: object
              properties:
                reference:
                  type: string
                  example: urn:uuid:2f808d78-c2f1-4e8b-8626-90f986d94cdd
        fullUrl:
          type: string
          example: urn:uuid:e0230cb2-8335-43b7-b7d2-673504a80a2f
    PractitionerRole:
      type: object
      properties:
        resource:
          type: object
          properties:
            resourceType:
              type: string
              enum: [PractitionerRole]
            id:
              type: string
              example: 3ee4cb3d-e3bb-4187-8533-fbf30524bd15
            identifier:
              type: array
              items:
                type: object
                properties:
                  system:
                    type: string
                    enum: [https://fhir.nhs.uk/Id/sds-role-profile-id]
                  value:
                    type: string
                    example: "601986680555"
            practitioner:
              type: object
              properties:
                reference:
                  type: string
                  example: urn:uuid:80eb635a-fb95-427f-9754-3ef9ca922994
            healthcareService:
              type: array
              items:
                type: object
                properties:
                  reference:
                    type: string
                    example: urn:uuid:e0230cb2-8335-43b7-b7d2-673504a80a2f
            code:
              type: array
              items:
                type: object
                properties:
                  coding:
                    type: array
                    items:
                      type: object
                      properties:
                        system:
                          type: string
                          enum: [https://fhir.hl7.org.uk/CodeSystem/UKCore-SDSJobRoleName]
                        code:
                          type: string
                          example: R8000
                        display:
                          type: string
                          example: Clinical Practitioner Access Role
            telecom:
              type: array
              items:
                type: object
                properties:
                  system:
                    type: string
                    example: phone
                  use:
                    type: string
                    enum: [billing, home, temp, work]
                  value:
                    type: string
                    example: 01234567890
            organization:
              type: object
              properties:
                reference:
                  type: string
                  example: urn:uuid:2f808d78-c2f1-4e8b-8626-90f986d94cdd
        fullUrl:
          type: string
          example: urn:uuid:3ee4cb3d-e3bb-4187-8533-fbf30524bd15
    Organization:
      type: object
      properties:
        resource:
          type: object
          properties:
            resourceType:
              type: string
              enum: [Organization]
            id:
              type: string
              example: 2f808d78-c2f1-4e8b-8626-90f986d94cdd
            identifier:
              type: array
              items:
                type: object
                properties:
                  system:
                    type: string
                    enum: [https://fhir.nhs.uk/Id/ods-organization-code]
                  value:
                    type: string
                    example: RBA
            type:
              type: array
              items:
                type: object
                properties:
                  coding:
                    type: array
                    items:
                      type: object
                      properties:
                        system:
                          type: string
                          enum: [https://fhir.nhs.uk/CodeSystem/organisation-role]
                        code:
                          type: string
                          example: "197"
                        display:
                          type: string
                          example: NHS TRUST
            name:
              type: string
              example: TAUNTON AND SOMERSET NHS FOUNDATION TRUST
        fullUrl:
          type: string
          example: urn:uuid:2f808d78-c2f1-4e8b-8626-90f986d94cdd
