type: object
properties:
  fullUrl:
    type: string
    example: urn:uuid:a54219b8-f741-4c47-b662-e4f8dfa49ab6
  resource:
    type: object
    properties:
      resourceType:
        type: string
        description: FHIR resource type
        default: MedicationRequest
      extension:
        type: array
        description: a FHIR extension array.
        items:
          allOf:
            - type: object
              properties:
                url:
                  type: string
                  example: https://fhir.nhs.uk/StructureDefinition/Extension-EPS-DispensingInformation
                extension:
                  type: array
                  items:
                    type: object
                    properties:
                      url:
                        type: string
                        example: dispenseStatus
                      valueCoding:
                        type: object
                        properties:
                          system:
                            type: string
                            example: https://fhir.nhs.uk/CodeSystem/medicationdispense-type
                          code:
                            type: string
                            format: date
                            example: "0008"
                          display:
                            type: string
                            example: Item with dispenser
            - type: object
              properties:
                url:
                  type: string
                  example: https://fhir.nhs.uk/StructureDefinition/Extension-DM-PrescriptionType
                valueCoding:
                  type: object
                  properties:
                    system:
                      type: string
                      example: https://fhir.nhs.uk/CodeSystem/prescription-type
                    code:
                      type: string
                      format: date
                      example: "0101"
                    display:
                      type: string
                      example: Primary Care Prescriber - Medical Prescriber
      identifier:
        type: array
        description: The unique ID for each line item on a prescription.
        items:
          type: object
          properties:
            system:
              type: string
              description: codesystem URL for the line item ID.
              enum:
                - https://fhir.nhs.uk/Id/prescription-order-item-number
            value:
              type: string
              description: the unique ID for a given line item.
              example: a54219b8-f741-4c47-b662-e4f8dfa49ab6
      status:
        type: string
        description: |
          The status of a MedicationRequest object. 
          
          This must be consistent across all MedicationRequests in a Bundle.
        enum:
          - active
          - cancelled
          - completed
      intent:
        type: string
        description: |
          The intent of a MedicationRequest object. 
          
          This must be consistent across all MedicationRequests in a Bundle.
        default: order
      category:
        type: array
        items:
          type: object
          properties:
            coding:
              type: array
              items:
                type: object
                properties:
                  system:
                    type: string
                    default: http://terminology.hl7.org/CodeSystem/medicationrequest-category
                  code:
                    type: string
                    example: community
                  display:
                    type: string
                    example: Community
      medicationCodeableConcept:
        type: object
        description: |
          The medication that is being cancelled. 
          
          This must be defined using VMP or AMP concepts from the dm+d.
        properties:
          coding:
            type: array
            items:
              type: object
              properties:
                system:
                  type: string
                  description: SNOMED codesystem URL
                  enum:
                    - http://snomed.info/sct
                code:
                  type: string
                  description: SNOMED code for the medication, as defined in the DM+D
                  example: "39732311000001104"
                display:
                  type: string
                  description: a human readable name for the medication.
                  example: Amoxicillin 250mg capsules
      subject:
        type: object
        description: |
          Reference object to identify the patient a prescription is for. 
          
          A Patient resource within the Bundle must be referenced.
        properties:
          reference:
            type: string
            description: A reference to a Patient resource within the Bundle
            example: urn:uuid:78d3c2eb-009e-4ec8-a358-b042954aa9b2
      authoredOn:
        type: string
        format: date-time
        example: "2023-03-13T13:47:00+00:00"
      requester:
        type: object
        description: |
          Reference object to identify the author of a prescription. 
          
          A PractitionerRole resource within the Bundle must be referenced.
        properties:
          reference:
            type: string
            description: A reference to a PractitionerRole resource within the Bundle
            example: urn:uuid:56166769-c1c4-4d07-afa8-132b5dfca666
      groupIdentifier:
        type: object
        description: An object containing the short-form and long-form Prescription ID.
        properties:
          system:
            type: string
            description: codesystem URL for the short-form Prescription ID
            enum:
              - https://fhir.nhs.uk/Id/prescription-order-number
          value:
            type: string
            description: The short-form Prescription ID
            example: 24F5DA-A83008-7EFE6Z
          extension:
            type: array
            description: A FHIR extension array containing the long-form Prescription ID.
            items:
              type: object
              properties:
                url:
                  type: string
                  enum: 
                    - https://fhir.nhs.uk/StructureDefinition/Extension-DM-PrescriptionId
                valueIdentifier:
                  type: object
                  properties:
                    system:
                      type: string
                      description: codesystem URL for the long-form Prescription ID
                      enum:
                        - https://fhir.nhs.uk/Id/prescription
                    value:
                      type: string
                      description: The long-form prescription ID
                      example: 20ba5fb5-cb58-462c-923e-22d180b09356
      courseOfTherapyType:
        type: object
        properties:
          coding:
            type: array
            items:
              type: object
              properties:
                system:
                  type: string
                  enum:
                    - http://terminology.hl7.org/CodeSystem/medicationrequest-course-of-therapy
                code:
                  type: string
                  enum:
                    - acute
                    - continuous
                    - continuous-repeat-dispensing
                display:
                  type: string
                  enum:
                    - Short course (acute) therapy
                    - Continuous long term therapy
                    - Continuous long term (repeat dispensing)
      dosageInstruction:
        type: array
        items:
          type: object
          properties:
            text:
              type: string
              example: 2 times a day for 10 days
            timing:
              type: object
              properties:
                repeat:
                  type: object
                  properties:
                    frequency:
                      type: integer
                      format: int32
                      example: 2
                    period:
                      type: integer
                      format: int32
                      example: 1
                    periodUnit:
                      type: string
                      example: d
            route:
              type: object
              properties:
                coding:
                  type: array
                  items:
                    type: object
                    properties:
                      system:
                        type: string
                        enum:
                          - http://snomed.info/sct
                      code:
                        type: string
                        example: "26643006"
                      display:
                        type: string
                        example: Oral
      dispenseRequest:
        type: object
        properties:
          extension:
            type: array
            items:
              type: object
              properties:
                url:
                  type: string
                  enum:
                    - https://fhir.nhs.uk/StructureDefinition/Extension-DM-PerformerSiteType
                valueCoding:
                  type: object
                  properties:
                    system:
                      type: string
                      enum:
                        - https://fhir.nhs.uk/CodeSystem/dispensing-site-preference
                    code:
                      type: string
                      example: P1
          validityPeriod:
            type: object
            properties:
              start:
                type: string
                format: date
                example: "2022-10-21"
          quantity:
            type: object
            properties:
              value:
                type: integer
                format: int32
                example: 20
              unit:
                type: string
                example: tablet
              system:
                type: string
                enum:
                  - http://snomed.info/sct
              code:
                type: string
                example: "428673006"
          expectedSupplyDuration:
            type: object
            properties:
              value:
                type: integer
                format: int32
                example: 10
              unit:
                type: string
                example: day
              system:
                type: string
                enum:
                  - http://unitsofmeasure.org
              code:
                type: string
                example: d
          performer:
            type: object
            properties:
              identifier:
                type: object
                properties:
                  system:
                    type: string
                    enum:
                      - https://fhir.nhs.uk/Id/ods-organization-code
                  value:
                    type: string
                    example: VNE51
      substitution:
        type: object
        properties:
          allowedBoolean:
            type: boolean
            example: false
